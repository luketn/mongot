participantspacing equal
lifelinestyle ::solid
participant ConfigState
participant ConfigManager
database ConfigJournalV1

ConfigManager->ConfigUpgrades:""moveConfigJournalFromLegacy()""
ConfigUpgrades-->ConfigJournalV1:Moves from legacy path
ConfigManager<-ConfigJournalV1:Reads from disk
ConfigManager->ConfigInitializer:""initialize()""
ConfigInitializer-->ConfigState:Populates with indexes
ConfigInitializer-->ConfigJournalV1:Writes updated state to disk
ConfigManager->IndexFormatVersionUpgrader:""upgradeAndDrop()""
IndexFormatVersionUpgrader-->ConfigState:Drops unsupported indexes and outdated staged indexes
IndexFormatVersionUpgrader-->ConfigState:Stages new format versions for outdated live indexes
IndexFormatVersionUpgrader-->ConfigJournalV1:Writes updated state to disk